<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <!-- ================= META & TITLE ================= -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title th:text="${pageTitle}">CodeCampus - Pro Coder Platform</title>

    <!-- ================= FONTS & ICONS ================= -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- ================= ANIMATION LIB (AOS) ================= -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <!-- ================= TAILWIND CSS ================= -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="/images/logo.png" />

    <!-- ================= CONFIG & CUSTOM CSS ================= -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Plus Jakarta Sans', 'sans-serif'], // Font hi·ªán ƒë·∫°i h∆°n Manrope cho Tech
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        brand: {
                            50: '#eef2ff',
                            100: '#e0e7ff',
                            200: '#c7d2fe',
                            300: '#a5b4fc',
                            400: '#818cf8',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca',
                            800: '#3730a3',
                            900: '#312e81',
                            950: '#1e1b4b',
                        },
                        dark: {
                            900: '#0f172a',
                            800: '#1e293b',
                        }
                    },
                    boxShadow: {
                        'glass': '0 8px 32px 0 rgba(31, 38, 135, 0.05)',
                        'glow': '0 0 40px -10px rgba(99, 102, 241, 0.5)',
                        'card-hover': '0 20px 40px -5px rgba(0, 0, 0, 0.1), 0 10px 20px -5px rgba(99, 102, 241, 0.1)',
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 6s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'spin-slow': 'spin 8s linear infinite',
                        'blob': 'blob 7s infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-15px)' },
                        },
                        blob: {
                            '0%': { transform: 'translate(0px, 0px) scale(1)' },
                            '33%': { transform: 'translate(30px, -50px) scale(1.1)' },
                            '66%': { transform: 'translate(-20px, 20px) scale(0.9)' },
                            '100%': { transform: 'translate(0px, 0px) scale(1)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* --- GLOBAL & SCROLLBAR --- */
        body {
            background-color: #f8fafc;
            /* Mesh Gradient N√¢ng cao: T·∫°o chi·ªÅu s√¢u 3D m·ªÅm m·∫°i */
            background-image:
                    radial-gradient(at 0% 0%, hsla(253,16%,7%,1) 0, transparent 50%),
                    radial-gradient(at 50% 0%, hsla(225,39%,30%,1) 0, transparent 50%),
                    radial-gradient(at 100% 0%, hsla(339,49%,30%,1) 0, transparent 50%);
            /* Override l·∫°i background cho Light Mode Aurora */
            background:
                    radial-gradient(at 0% 0%, rgba(99, 102, 241, 0.15) 0px, transparent 50%), /* Top Left Indigo */
                    radial-gradient(at 100% 0%, rgba(236, 72, 153, 0.1) 0px, transparent 50%), /* Top Right Pink */
                    radial-gradient(at 100% 100%, rgba(56, 189, 248, 0.12) 0px, transparent 50%), /* Bottom Right Sky */
                    radial-gradient(at 0% 100%, rgba(168, 85, 247, 0.1) 0px, transparent 50%), /* Bottom Left Purple */
                    radial-gradient(at 50% 50%, rgba(255, 255, 255, 0.8) 0px, transparent 100%); /* Center Light */
            background-color: #f9fafb; /* Base slate-50 */
            background-attachment: fixed;
            background-size: 100% 100%;
            color: #1e293b;
            overflow-x: hidden;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: linear-gradient(to bottom, #c7d2fe, #6366f1); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #4f46e5; }

        /* --- GLASSMORPHISM V2 --- */
        .glass-panel {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.6);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.65);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .glass-card:hover {
            background: rgba(255, 255, 255, 0.85); /* TƒÉng ƒë·ªô s√°ng khi hover */
            transform: translateY(-8px) scale(1.005);
            border-color: rgba(99, 102, 241, 0.4);
            box-shadow: 0 20px 40px -5px rgba(99, 102, 241, 0.15), 0 10px 20px -5px rgba(0, 0, 0, 0.04); /* Colored Shadow */
        }

        /* --- UTILS --- */
        .text-gradient { background: linear-gradient(135deg, #4f46e5 0%, #ec4899 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .text-gradient-gold { background: linear-gradient(135deg, #fbbf24 0%, #d97706 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        /* Smooth Image Zoom */
        .img-zoom-container { overflow: hidden; }
        .img-zoom-container img { transition: transform 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
        .group:hover .img-zoom-container img { transform: scale(1.1); }

        /* Chat Animations */
        .message-enter { animation: slideUpFade 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes slideUpFade { from { opacity: 0; transform: translateY(15px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }
    </style>
</head>

<body class="antialiased font-sans selection:bg-brand-500 selection:text-white">

<!-- ================= HEADER ================= -->
<div class="sticky top-0 z-50 glass-panel shadow-sm transition-all duration-300">
    <div class="text-slate-900">
        <div th:replace="~{fragments/header :: header}"></div>
    </div>
</div>

<div class="flex max-w-[1500px] mx-auto pt-8 px-4 sm:px-6 gap-10 relative pb-24">

    <!-- ================= DECOR BACKGROUND ELEMENTS (UPDATED) ================= -->
    <div class="fixed inset-0 -z-10 overflow-hidden pointer-events-none">
        <!-- Blob 1: Indigo (Top Left) -->
        <div class="absolute top-0 left-0 w-[800px] h-[800px] bg-brand-400/20 rounded-full blur-[120px] mix-blend-multiply animate-blob opacity-70"></div>

        <!-- Blob 2: Purple (Top Right) -->
        <div class="absolute top-0 right-0 w-[800px] h-[800px] bg-purple-300/20 rounded-full blur-[120px] mix-blend-multiply animate-blob animation-delay-2000 opacity-70"></div>

        <!-- Blob 3: Teal/Cyan (Bottom Center) - Th√™m m·ªõi ƒë·ªÉ t·∫°o s·ª± t∆∞∆°i m√°t -->
        <div class="absolute -bottom-32 left-1/2 -translate-x-1/2 w-[800px] h-[800px] bg-cyan-300/20 rounded-full blur-[120px] mix-blend-multiply animate-blob animation-delay-4000 opacity-70"></div>

        <!-- Grid pattern overlay -->
        <div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-[0.04]"></div>
    </div>

    <!-- ================= MODERN DOCK SIDEBAR ================= -->
    <aside class="hidden xl:flex flex-col items-center sticky top-32 h-fit z-30">
        <div class="flex flex-col gap-5 bg-white/70 backdrop-blur-xl rounded-full px-3 py-6 shadow-[0_8px_30px_rgb(0,0,0,0.06)] border border-white/60 ring-1 ring-slate-100/50">

            <a href="/home" class="group relative w-12 h-12 flex items-center justify-center rounded-full bg-white text-slate-400 transition-all duration-300 hover:bg-brand-600 hover:text-white hover:scale-110 hover:shadow-lg hover:shadow-brand-500/40">
                <i class="fa-solid fa-house text-lg"></i>
                <span class="absolute left-full ml-4 px-3 py-1.5 bg-slate-800 text-white text-xs font-bold rounded-lg opacity-0 group-hover:opacity-100 transition-all translate-x-[-10px] group-hover:translate-x-0 whitespace-nowrap shadow-xl">Trang ch·ªß</span>
            </a>

            <a href="/courses" class="group relative w-12 h-12 flex items-center justify-center rounded-full bg-white text-slate-400 transition-all duration-300 hover:bg-emerald-500 hover:text-white hover:scale-110 hover:shadow-lg hover:shadow-emerald-500/40">
                <i class="fa-solid fa-layer-group text-lg"></i>
                <span class="absolute left-full ml-4 px-3 py-1.5 bg-slate-800 text-white text-xs font-bold rounded-lg opacity-0 group-hover:opacity-100 transition-all translate-x-[-10px] group-hover:translate-x-0 whitespace-nowrap shadow-xl">Kh√≥a h·ªçc</span>
            </a>

            <a href="/blog" class="group relative w-12 h-12 flex items-center justify-center rounded-full bg-white text-slate-400 transition-all duration-300 hover:bg-orange-500 hover:text-white hover:scale-110 hover:shadow-lg hover:shadow-orange-500/40">
                <i class="fa-regular fa-newspaper text-lg"></i>
                <span class="absolute left-full ml-4 px-3 py-1.5 bg-slate-800 text-white text-xs font-bold rounded-lg opacity-0 group-hover:opacity-100 transition-all translate-x-[-10px] group-hover:translate-x-0 whitespace-nowrap shadow-xl">B√†i vi·∫øt</span>
            </a>

            <div class="w-8 h-[1px] bg-slate-200 mx-auto"></div>

            <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="group relative w-10 h-10 flex items-center justify-center rounded-full text-slate-300 hover:text-brand-500 transition-colors">
                <i class="fa-solid fa-arrow-up"></i>
            </button>
        </div>
    </aside>

    <!-- ================= MAIN CONTENT ================= -->
    <main class="flex-1 w-full min-w-0 space-y-20">

        <!-- ================= HERO SLIDER (Immersive) ================= -->
        <section class="relative rounded-[2.5rem] overflow-hidden shadow-2xl group border border-white/50 ring-1 ring-slate-900/5" data-aos="zoom-in" data-aos-duration="1000">
            <div class="flex transition-transform duration-700 ease-[cubic-bezier(0.25,1,0.5,1)]" id="slider-wrapper">
                <div th:each="slider : ${sliders}" class="min-w-full relative shrink-0">
                    <!-- T·ª∑ l·ªá khung h√¨nh ƒëi·ªán ·∫£nh 21:9 -->
                    <div class="w-full relative bg-slate-900 overflow-hidden" style="aspect-ratio: 21/9;">

                        <!-- ·∫¢nh n·ªÅn v·ªõi hi·ªáu ·ª©ng Ken Burns -->
                        <div class="absolute inset-0 bg-cover bg-center transition-transform duration-[15s] ease-linear hover:scale-110 animate-ken-burns"
                             th:style="'background-image: url(' + ${slider.imageUrl} + ');'"></div>

                        <!-- Gradient Overlay m∆∞·ª£t m√† -->
                        <div class="absolute inset-0 bg-gradient-to-r from-slate-950/95 via-slate-900/60 to-transparent"></div>
                        <div class="absolute inset-0 bg-gradient-to-t from-slate-950/50 to-transparent"></div>

                        <!-- Content -->
                        <div class="absolute inset-0 flex flex-col justify-center px-8 md:px-24 max-w-6xl z-10">
                            <div data-aos="fade-right" data-aos-delay="200">
                                <span class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-white/10 backdrop-blur-md text-white border border-white/20 text-[11px] font-bold tracking-widest mb-6 uppercase shadow-glow">
                                    <span class="relative flex h-2 w-2">
                                      <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                                      <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
                                    </span>
                                    Trending Now
                                </span>
                            </div>

                            <h2 class="text-3xl md:text-5xl lg:text-7xl font-extrabold text-white leading-[1.1] mb-6 drop-shadow-xl tracking-tight"
                                data-aos="fade-up" data-aos-delay="300"
                                th:text="${slider.title}">Slider Title</h2>

                            <p class="text-base md:text-xl text-slate-300 font-medium mb-10 line-clamp-2 max-w-2xl leading-relaxed opacity-90 border-l-4 border-brand-500 pl-6"
                               data-aos="fade-up" data-aos-delay="400"
                               th:text="${slider.notes}">Description</p>

                            <div data-aos="fade-up" data-aos-delay="500">
                                <a th:href="${slider.backlink}" class="group/btn relative inline-flex items-center px-8 py-4 bg-white text-slate-900 font-bold rounded-2xl transition-all duration-300 hover:bg-brand-400 hover:text-white hover:scale-105 shadow-[0_0_40px_rgba(255,255,255,0.3)]">
                                    <span class="text-sm uppercase tracking-wider">Kh√°m ph√° ngay</span>
                                    <i class="fa-solid fa-arrow-right ml-3 transition-transform duration-300 group-hover/btn:translate-x-2"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Dots -->
            <div class="absolute bottom-8 left-1/2 -translate-x-1/2 flex space-x-3 z-20 p-2 bg-black/20 backdrop-blur rounded-full border border-white/10" id="slider-dots"></div>
        </section>

        <!-- ================= STATS SECTION (Moved Up for Trust) ================= -->
        <section id="system-stats" class="relative">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                <div class="glass-card rounded-2xl p-6 text-center group" data-aos="fade-up" data-aos-delay="0">
                    <div class="mb-3 flex justify-center"><div class="w-12 h-12 bg-brand-50 rounded-xl flex items-center justify-center text-brand-600 text-2xl group-hover:scale-110 transition-transform"><i class="fa-solid fa-users"></i></div></div>
                    <div class="text-3xl font-black text-slate-800 mb-1 tracking-tight">
                        <span id="totalStudents" th:data-target="${totalStudents}" class="counter">0</span>+
                    </div>
                    <div class="text-xs font-bold text-slate-500 uppercase tracking-wider">H·ªçc vi√™n</div>
                </div>

                <div class="glass-card rounded-2xl p-6 text-center group" data-aos="fade-up" data-aos-delay="100">
                    <div class="mb-3 flex justify-center"><div class="w-12 h-12 bg-emerald-50 rounded-xl flex items-center justify-center text-emerald-600 text-2xl group-hover:scale-110 transition-transform"><i class="fa-solid fa-check-double"></i></div></div>
                    <div class="text-3xl font-black text-slate-800 mb-1 tracking-tight">
                        <span id="todayStudents" th:data-target="${todayStudents}" class="counter">0</span>
                    </div>
                    <div class="text-xs font-bold text-slate-500 uppercase tracking-wider">Online H√¥m nay</div>
                </div>

                <div class="glass-card rounded-2xl p-6 text-center group" data-aos="fade-up" data-aos-delay="200">
                    <div class="mb-3 flex justify-center"><div class="w-12 h-12 bg-orange-50 rounded-xl flex items-center justify-center text-orange-600 text-2xl group-hover:scale-110 transition-transform"><i class="fa-solid fa-fire"></i></div></div>
                    <div class="text-3xl font-black text-slate-800 mb-1 tracking-tight">
                        <span id="topCourseEnroll" th:data-target="${topCourseEnroll}" class="counter">0</span>+
                    </div>
                    <div class="text-xs font-bold text-slate-500 uppercase tracking-wider">ƒêƒÉng k√Ω m·ªõi</div>
                </div>

                <div class="glass-card rounded-2xl p-6 text-center group" data-aos="fade-up" data-aos-delay="300">
                    <div class="mb-3 flex justify-center"><div class="w-12 h-12 bg-purple-50 rounded-xl flex items-center justify-center text-purple-600 text-2xl group-hover:scale-110 transition-transform"><i class="fa-solid fa-graduation-cap"></i></div></div>
                    <div class="text-3xl font-black text-slate-800 mb-1 tracking-tight">
                        <span id="completionRate" th:data-target="${completionRate}" class="counter">0</span>%
                    </div>
                    <div class="text-xs font-bold text-slate-500 uppercase tracking-wider">T·ª∑ l·ªá ho√†n th√†nh</div>
                </div>
            </div>
        </section>

        <!-- ================= COURSES SECTION ================= -->
        <section>
            <!-- Header -->
            <div class="flex items-end justify-between mb-10" data-aos="fade-up">
                <div>
                    <div class="flex items-center gap-2 mb-2">
                        <span class="w-2 h-2 rounded-full bg-brand-500"></span>
                        <span class="text-brand-600 font-bold tracking-widest uppercase text-xs">Roadmap To Senior</span>
                    </div>
                    <h3 class="text-4xl font-extrabold text-slate-900">
                        Kh√≥a h·ªçc <span class="text-transparent bg-clip-text bg-gradient-to-r from-brand-600 to-purple-600">PRO</span>
                    </h3>
                </div>
                <a href="/courses" class="hidden sm:inline-flex items-center justify-center px-6 py-2.5 text-sm font-bold text-slate-600 transition-all duration-200 bg-white border border-slate-200 rounded-full hover:bg-slate-50 hover:text-brand-600 hover:border-brand-200 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500">
                    Xem t·∫•t c·∫£
                    <i class="fa-solid fa-arrow-right ml-2 text-xs"></i>
                </a>
            </div>

            <!-- Grid -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                <div th:each="course, iterStat : ${featuredCourses}"
                     class="glass-card group rounded-[2rem] flex flex-col h-full overflow-hidden relative"
                     th:attr="data-aos='fade-up', data-aos-delay=${iterStat.index * 100}">

                    <!-- Thumbnail Container -->
                    <a th:href="@{'/courses/' + ${course.id}}" class="block relative aspect-[4/3] img-zoom-container cursor-pointer">
                        <img th:src="${course.thumbnailUrl}" class="w-full h-full object-cover"/>
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-60 group-hover:opacity-40 transition-opacity"></div>

                        <!-- Badges -->
                        <div class="absolute top-4 left-4 flex flex-col gap-2">
                            <span class="bg-white/90 backdrop-blur-sm text-slate-900 text-[10px] font-black px-3 py-1.5 rounded-lg uppercase shadow-lg border border-white flex items-center gap-1.5">
                                <i class="fa-solid fa-bolt text-yellow-500"></i> PRO
                            </span>
                        </div>

                        <!-- Overlay Play Button -->
                        <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300 scale-50 group-hover:scale-100">
                            <div class="w-14 h-14 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center border border-white/50 text-white shadow-glow">
                                <i class="fa-solid fa-play ml-1 text-xl"></i>
                            </div>
                        </div>
                    </a>

                    <!-- Content -->
                    <div class="p-6 flex flex-col flex-1">
                        <!-- Rating & Students -->
                        <div class="flex justify-between items-center mb-3">
                            <div class="flex items-center text-xs font-bold text-yellow-500 bg-yellow-50 px-2 py-1 rounded-md border border-yellow-100">
                                <i class="fa-solid fa-star mr-1"></i>
                                <span th:text="${course.averageRating != null ? course.averageRating : 5.0}">4.9</span>
                            </div>
                            <span class="text-xs font-medium text-slate-400 flex items-center">
                                <i class="fa-solid fa-user-group mr-1.5"></i>
                                <span th:text="${course.studentCount}"></span>+ h·ªçc vi√™n
                            </span>
                        </div>

                        <h4 class="font-bold text-xl text-slate-800 group-hover:text-brand-600 transition-colors mb-2 line-clamp-2 leading-snug h-[3.5rem]"
                            th:text="${course.name}">T√™n kh√≥a h·ªçc</h4>

                        <p class="text-sm text-slate-500 mb-5 line-clamp-2 leading-relaxed"
                           th:text="${course.description != null ? course.description : #strings.abbreviate(course.description, 100)}">
                            M√¥ t·∫£...
                        </p>

                        <!-- Footer -->
                        <div class="mt-auto pt-4 border-t border-slate-100 flex items-center justify-between">
                            <div class="flex -space-x-2 overflow-hidden">
                                <img class="inline-block h-6 w-6 rounded-full ring-2 ring-white" src="https://i.pravatar.cc/100?img=1" alt=""/>
                                <img class="inline-block h-6 w-6 rounded-full ring-2 ring-white" src="https://i.pravatar.cc/100?img=2" alt=""/>
                                <img class="inline-block h-6 w-6 rounded-full ring-2 ring-white" src="https://i.pravatar.cc/100?img=3" alt=""/>
                            </div>
                            <a th:href="@{'/courses/' + ${course.id}}" class="text-slate-900 group-hover:text-brand-600 font-bold text-xs uppercase tracking-wider flex items-center transition-colors">
                                Chi ti·∫øt <i class="fa-solid fa-arrow-right-long ml-2"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ================= CREATIVE EXTRA: WHY CHOOSE US ================= -->
        <section class="py-10" data-aos="fade-up">
            <div class="bg-gradient-to-br from-slate-900 to-slate-800 rounded-[2.5rem] p-10 md:p-16 relative overflow-hidden text-white shadow-2xl">
                <!-- Decor -->
                <div class="absolute top-0 right-0 w-96 h-96 bg-brand-500/20 rounded-full blur-[100px]"></div>
                <div class="absolute bottom-0 left-0 w-72 h-72 bg-purple-500/20 rounded-full blur-[80px]"></div>

                <div class="relative z-10 grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                    <div>
                        <h3 class="text-3xl md:text-4xl font-black mb-6 leading-tight">T·∫°i sao ch·ªçn <span class="text-brand-400">CodeCampus?</span></h3>
                        <p class="text-slate-300 mb-8 text-lg leading-relaxed">Ch√∫ng t√¥i kh√¥ng ch·ªâ d·∫°y Code, ch√∫ng t√¥i ƒë·ªãnh h√¨nh t∆∞ duy l·∫≠p tr√¨nh vi√™n chuy√™n nghi·ªáp. Gi√°o tr√¨nh th·ª±c chi·∫øn, mentor 1:1 v√† c·ªông ƒë·ªìng ch·∫•t l∆∞·ª£ng.</p>

                        <div class="space-y-4">
                            <div class="flex items-center gap-4 p-4 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 transition-colors">
                                <div class="w-10 h-10 rounded-lg bg-brand-500/20 flex items-center justify-center text-brand-300"><i class="fa-solid fa-code"></i></div>
                                <div>
                                    <h5 class="font-bold">D·ª± √°n th·ª±c t·∫ø</h5>
                                    <p class="text-xs text-slate-400">H·ªçc qua l√†m, commit code m·ªói ng√†y.</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-4 p-4 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 transition-colors">
                                <div class="w-10 h-10 rounded-lg bg-emerald-500/20 flex items-center justify-center text-emerald-300"><i class="fa-solid fa-certificate"></i></div>
                                <div>
                                    <h5 class="font-bold">Ch·ª©ng ch·ªâ uy t√≠n</h5>
                                    <p class="text-xs text-slate-400">ƒê∆∞·ª£c c√¥ng nh·∫≠n b·ªüi c√°c c√¥ng ty Tech h√†ng ƒë·∫ßu.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="relative hidden lg:block h-full min-h-[300px]">
                        <!-- Abstract Code UI Simulation -->
                        <div class="absolute right-0 top-1/2 -translate-y-1/2 w-full max-w-md bg-slate-950 rounded-xl border border-slate-700 p-4 shadow-2xl rotate-3 hover:rotate-0 transition-transform duration-500">
                            <div class="flex gap-2 mb-4">
                                <div class="w-3 h-3 rounded-full bg-red-500"></div>
                                <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                            </div>
                            <div class="space-y-2 font-mono text-xs">
                                <div class="text-purple-400">const <span class="text-yellow-300">futureDev</span> = <span class="text-blue-400">new</span> Developer();</div>
                                <div class="text-slate-400 pl-4">futureDev.<span class="text-blue-300">learn</span>(<span class="text-green-300">'CodeCampus'</span>);</div>
                                <div class="text-slate-400 pl-4">futureDev.<span class="text-blue-300">upgradeSkill</span>(<span class="text-orange-300">'Fullstack'</span>);</div>
                                <div class="text-slate-400 pl-4">await futureDev.<span class="text-blue-300">getJob</span>(<span class="text-green-300">'$2000'</span>);</div>
                                <div class="text-brand-400 animate-pulse">console.log("Success!");</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ================= BLOG SECTION ================= -->
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-10">

            <!-- ===== MAIN (8/12) ===== -->
            <div class="lg:col-span-8 space-y-8">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <span class="w-1.5 h-8 bg-gradient-to-b from-orange-500 to-red-600 rounded-full"></span>
                        <h3 class="text-3xl font-extrabold text-slate-900">Chia s·∫ª ki·∫øn th·ª©c</h3>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div th:each="post : ${hotPosts}" class="glass-card group rounded-[1.5rem] flex flex-col h-full overflow-hidden hover:shadow-card-hover" data-aos="fade-up">
                        <a th:href="@{'/blog/' + ${post.id}}" class="relative overflow-hidden aspect-[16/10] img-zoom-container">
                            <img th:src="${post.thumbnailUrl}" class="w-full h-full object-cover"/>
                            <div class="absolute bottom-4 left-4 bg-white/95 backdrop-blur text-slate-800 text-[11px] font-bold px-3 py-1.5 rounded-lg border border-white/50 shadow-sm">
                                <i class="fa-regular fa-clock mr-1 text-orange-500"></i>
                                <span th:text="${#temporals.format(post.publishedAt ?: post.updatedAt, 'dd/MM/yyyy')}">Date</span>
                            </div>
                        </a>

                        <div class="p-6 flex-1 flex flex-col">
                            <h4 class="text-lg font-bold text-slate-800 group-hover:text-brand-600 transition-colors mb-3 line-clamp-2 leading-snug">
                                <a th:href="@{'/blog/' + ${post.id}}" th:text="${post.title}">Ti√™u ƒë·ªÅ</a>
                            </h4>

                            <p class="text-sm text-slate-500 mb-6 line-clamp-3 leading-relaxed" th:text="${post.content != null ? post.content : #strings.abbreviate(post.content, 100)}">
                                T√≥m t·∫Øt...
                            </p>

                            <div class="mt-auto pt-4 border-t border-dashed border-slate-200 flex items-center justify-between">
                                <div class="flex items-center gap-2">
                                    <div class="w-8 h-8 rounded-full bg-gradient-to-br from-slate-200 to-slate-300 p-[1px]">
                                        <div class="w-full h-full bg-white rounded-full flex items-center justify-center text-xs text-slate-500 font-bold">
                                            <i class="fa-solid fa-user-pen"></i>
                                        </div>
                                    </div>
                                    <span class="text-xs text-slate-600 font-bold" th:text="${post.author != null ? post.author.fullName : 'Admin'}">Author</span>
                                </div>
                                <a th:href="@{'/blog/' + ${post.id}}" class="text-orange-500 text-xs font-black uppercase hover:tracking-wide transition-all">
                                    ƒê·ªçc ngay
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ===== SIDEBAR (4/12) ===== -->
            <div class="lg:col-span-4 space-y-8">
                <div class="glass-panel bg-white/50 rounded-3xl p-6 sticky top-32 border border-white shadow-[0_8px_30px_rgb(0,0,0,0.04)]">
                    <h3 class="text-lg font-bold text-slate-800 mb-6 flex items-center gap-3 pb-4 border-b border-slate-200/50">
                        <span class="w-8 h-8 rounded-lg bg-brand-100 text-brand-600 flex items-center justify-center"><i class="fa-solid fa-rss"></i></span>
                        M·ªõi xu·∫•t b·∫£n
                    </h3>

                    <div class="space-y-6">
                        <div th:each="post : ${latestPostsForSidebar}" class="group flex items-start gap-4">
                            <a th:href="@{'/blog/' + ${post.id}}" class="shrink-0 overflow-hidden rounded-xl w-24 h-24 shadow-sm group-hover:shadow-md transition-all">
                                <img th:src="${post.thumbnailUrl}" class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500"/>
                            </a>

                            <div class="flex-1 min-w-0 py-1">
                                <span class="text-[10px] text-brand-500 font-bold uppercase tracking-wider mb-1 block">Tin t·ª©c</span>
                                <a th:href="@{'/blog/' + ${post.id}}"
                                   class="block text-sm font-bold text-slate-800 line-clamp-2 mb-2 group-hover:text-brand-600 transition-colors leading-snug"
                                   th:text="${post.title}">Title</a>
                                <p class="text-[10px] text-slate-400 font-medium">
                                    <i class="fa-regular fa-calendar mr-1"></i>
                                    <span th:text="${#temporals.format(post.publishedAt ?: post.updatedAt, 'dd/MM/yyyy')}"></span>
                                </p>
                            </div>
                        </div>
                    </div>

                    <a href="/blog" class="group block mt-8 text-center text-xs font-bold text-slate-500 hover:text-white bg-slate-50 border border-slate-200 rounded-xl py-3 hover:bg-slate-800 hover:border-slate-800 transition-all">
                        Xem t·∫•t c·∫£ b√†i vi·∫øt <i class="fa-solid fa-arrow-right ml-1 transition-transform group-hover:translate-x-1"></i>
                    </a>
                </div>
            </div>
        </div>

        <!-- ================= FEEDBACK SECTION ================= -->
        <section id="feedback" class="py-16 relative">
            <div class="absolute inset-x-0 top-1/2 -translate-y-1/2 h-[300px] bg-gradient-to-r from-brand-50/50 via-purple-50/50 to-brand-50/50 -z-10 skew-y-3"></div>

            <div class="text-center mb-16" data-aos="fade-down">
                <span class="text-brand-600 font-extrabold tracking-widest uppercase text-[10px] bg-white px-4 py-1.5 rounded-full shadow-sm border border-brand-100">
                    Trusted By Developers
                </span>
                <h2 class="text-4xl md:text-5xl font-black text-slate-900 mt-6 mb-4">C·ªông ƒë·ªìng n√≥i g√¨?</h2>
                <p class="text-slate-500 max-w-2xl mx-auto">Nh·ªØng review ch√¢n th·ª±c nh·∫•t t·ª´ c√°c h·ªçc vi√™n ƒë√£ t·ªët nghi·ªáp v√† ƒëang l√†m vi·ªác t·∫°i c√°c t·∫≠p ƒëo√†n c√¥ng ngh·ªá.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div th:each="fb, iterStat : ${feedbacks}"
                     class="bg-white/80 backdrop-blur-md rounded-3xl p-8 shadow-glass hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 border border-white relative group"
                     th:attr="data-aos='fade-up', data-aos-delay=${iterStat.index * 100}">

                    <div class="text-brand-100 absolute top-6 right-8 text-8xl font-serif leading-none select-none opacity-50 group-hover:text-brand-200 transition-colors">‚Äù</div>

                    <div class="flex items-center mb-6 text-yellow-400 text-sm gap-1">
                        <th:block th:each="i : ${#numbers.sequence(1, 5)}">
                            <i th:class="${i <= fb.rating} ? 'fa-solid fa-star drop-shadow-sm' : 'fa-regular fa-star text-slate-200'"></i>
                        </th:block>
                    </div>

                    <p class="text-slate-700 mb-8 relative z-10 italic leading-relaxed font-medium" th:text="${fb.comment}">Comment content</p>

                    <div class="flex items-center mt-auto pt-6 border-t border-slate-100 gap-4">
                        <div class="relative">
                            <img class="w-12 h-12 rounded-full object-cover ring-2 ring-white shadow-md"
                                 th:src="${fb.user.avatarUrl != null ? fb.user.avatarUrl : '/images/default-avatar.png'}"
                                 alt="User Avatar">
                            <div class="absolute -bottom-1 -right-1 bg-green-500 w-4 h-4 rounded-full border-2 border-white"></div>
                        </div>
                        <div>
                            <h4 class="text-sm font-bold text-slate-900" th:text="${fb.user.fullName}">Name</h4>
                            <p class="text-[10px] text-brand-600 font-bold uppercase bg-brand-50 px-2 py-0.5 rounded mt-0.5 inline-block" th:text="${fb.course.name}">Course</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ================= NEWSLETTER & CTA (Creative Addition) ================= -->
        <section class="mb-10" data-aos="zoom-in-up">
            <div class="bg-slate-900 rounded-[2.5rem] p-10 md:p-16 text-center relative overflow-hidden group">
                <!-- Animated Background -->
                <div class="absolute top-0 left-0 w-full h-full bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-10"></div>
                <div class="absolute inset-0 bg-gradient-to-r from-brand-600/20 to-purple-600/20 opacity-0 group-hover:opacity-100 transition-opacity duration-1000"></div>

                <div class="relative z-10 max-w-3xl mx-auto">
                    <h2 class="text-3xl md:text-5xl font-black text-white mb-6">S·∫µn s√†ng tr·ªü th√†nh Pro Coder?</h2>
                    <p class="text-slate-400 mb-8 text-lg">ƒêƒÉng k√Ω nh·∫≠n tin ƒë·ªÉ kh√¥ng b·ªè l·ª° c√°c b√†i vi·∫øt chuy√™n s√¢u v√† m√£ gi·∫£m gi√° kh√≥a h·ªçc ƒë·ªôc quy·ªÅn.</p>

                    <form class="flex flex-col sm:flex-row gap-3 max-w-lg mx-auto">
                        <input type="email" placeholder="Email c·ªßa b·∫°n..." class="flex-1 px-6 py-4 rounded-xl bg-white/10 border border-white/20 text-white placeholder-slate-400 focus:outline-none focus:bg-white/20 focus:border-brand-500 transition-all backdrop-blur-sm">
                        <button type="button" class="px-8 py-4 bg-brand-600 hover:bg-brand-500 text-white font-bold rounded-xl shadow-lg shadow-brand-600/30 transition-all hover:scale-105">
                            ƒêƒÉng k√Ω ngay
                        </button>
                    </form>
                    <p class="text-xs text-slate-500 mt-4">Kh√¥ng spam. H·ªßy ƒëƒÉng k√Ω b·∫•t c·ª© l√∫c n√†o.</p>
                </div>
            </div>
        </section>

    </main>
</div>

<!-- ================= AI CHAT WIDGET (Glass Float) ================= -->
<div class="fixed bottom-8 right-8 z-50 flex flex-col items-end pointer-events-none font-sans">

    <!-- Chat Window -->
    <div id="ai-chat-window" class="pointer-events-auto bg-white/80 backdrop-blur-xl w-[380px] h-[600px] rounded-3xl shadow-2xl border border-white/50 mb-4 transform transition-all duration-400 translate-y-10 opacity-0 invisible flex flex-col overflow-hidden ring-1 ring-slate-900/5 origin-bottom-right">

        <!-- Header -->
        <div class="bg-gradient-to-r from-brand-600 to-brand-700 px-6 py-5 flex items-center justify-between cursor-pointer shadow-md relative overflow-hidden" id="header-chat">
            <!-- Shine Effect -->
            <div class="absolute top-0 -left-full w-1/2 h-full bg-gradient-to-r from-transparent via-white/20 to-transparent skew-x-12 animate-[shimmer_2s_infinite]"></div>

            <div class="flex items-center space-x-3 relative z-10">
                <div class="w-10 h-10 rounded-full bg-white/20 flex items-center justify-center text-xl backdrop-blur-sm border border-white/20 shadow-inner">
                    ü§ñ
                </div>
                <div>
                    <h4 class="font-bold text-base text-white">CodeCampus AI</h4>
                    <div class="flex items-center space-x-1.5">
                        <span class="w-2 h-2 bg-emerald-400 rounded-full animate-pulse shadow-[0_0_10px_#34d399]"></span>
                        <span class="text-[11px] text-white/90 font-medium">Online</span>
                    </div>
                </div>
            </div>
            <div class="flex items-center gap-1 relative z-10">
                <button id="clear-chat" class="w-8 h-8 flex items-center justify-center text-white/70 hover:text-white hover:bg-white/10 rounded-full transition-colors" title="X√≥a l·ªãch s·ª≠">
                    <i class="fa-solid fa-trash-can text-xs"></i>
                </button>
                <button id="close-chat" class="w-8 h-8 flex items-center justify-center text-white/70 hover:text-white hover:bg-white/10 rounded-full transition-colors">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
        </div>

        <!-- Messages -->
        <div id="chat-messages" class="flex-1 bg-slate-50/50 p-5 overflow-y-auto space-y-4 scroll-smooth"></div>

        <!-- Input -->
        <div class="p-4 bg-white/90 border-t border-slate-100 shrink-0">
            <form id="chat-form" class="relative flex items-center gap-2">
                <input type="text" id="chat-input" placeholder="H·ªèi t√¥i v·ªÅ l·ªô tr√¨nh h·ªçc..." required
                       class="w-full bg-slate-100 text-slate-800 text-sm rounded-2xl py-3.5 pl-5 pr-12 focus:outline-none focus:ring-2 focus:ring-brand-500/50 focus:bg-white transition-all placeholder-slate-400 shadow-inner">
                <button type="submit" class="absolute right-2 p-2 bg-brand-600 hover:bg-brand-700 text-white rounded-xl transition-all shadow-md hover:shadow-lg hover:scale-105 w-9 h-9 flex items-center justify-center">
                    <i class="fa-solid fa-paper-plane text-xs"></i>
                </button>
            </form>
            <div class="text-[10px] text-center text-slate-400 mt-2 flex justify-center gap-2">
                <span>N·ªôi dung ƒë∆∞·ª£c AI ƒë·ªÅ xu·∫•t, kh√¥ng thay th·∫ø t∆∞ v·∫•n chuy√™n m√¥n</span>
            </div>
        </div>
    </div>

    <!-- Floating Toggle Button -->
    <button id="toggle-chat" class="pointer-events-auto group relative flex items-center justify-center w-16 h-16 bg-gradient-to-br from-brand-600 to-brand-700 text-white rounded-full shadow-[0_8px_30px_rgba(79,70,229,0.4)] hover:shadow-[0_15px_40px_rgba(79,70,229,0.6)] transition-all duration-300 animate-float hover:scale-110 border-4 border-white z-50">
        <i class="fa-solid fa-robot text-2xl group-hover:rotate-12 transition-transform"></i>
        <span class="absolute top-1 right-1 flex h-4 w-4">
          <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
          <span class="relative inline-flex rounded-full h-4 w-4 bg-red-500 border-2 border-white"></span>
        </span>
    </button>
</div>

<!-- ================= FOOTER ================= -->
<div class="relative bg-white border-t border-slate-200 pt-10">
    <div th:replace="~{fragments/footer :: footer}"></div>
</div>

<!-- ================= SCRIPTS ================= -->
<!-- AOS Library -->
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

<script>
    // Initialize Animations
    AOS.init({
        once: true,
        offset: 50,
        duration: 800,
        easing: 'ease-out-cubic',
    });

    document.addEventListener('DOMContentLoaded', function () {

        // --- 1. HERO SLIDER LOGIC (Preserved & Enhanced) ---
        const sliderWrapper = document.getElementById('slider-wrapper');
        const sliderDotsContainer = document.getElementById('slider-dots');

        if (sliderWrapper && sliderWrapper.children.length > 0) {
            const slides = sliderWrapper.children;
            const totalSlides = slides.length;
            let currentSlide = 0;
            let slideInterval;

            for (let i = 0; i < totalSlides; i++) {
                const dot = document.createElement('div');
                dot.className = `h-2 rounded-full cursor-pointer transition-all duration-300 ${i === 0 ? 'w-8 bg-white shadow-glow' : 'w-2 bg-white/30 hover:bg-white/60'}`;
                dot.addEventListener('click', () => { goToSlide(i); resetInterval(); });
                sliderDotsContainer.appendChild(dot);
            }
            const dots = sliderDotsContainer.children;

            function updateDots() {
                for (let i = 0; i < dots.length; i++) {
                    dots[i].className = 'h-2 w-2 bg-white/30 hover:bg-white/60 rounded-full transition-all duration-300';
                }
                dots[currentSlide].className = 'h-2 w-8 bg-white rounded-full transition-all duration-300 shadow-glow';
            }

            function goToSlide(slideIndex) {
                currentSlide = slideIndex;
                sliderWrapper.style.transform = `translateX(-${currentSlide * 100}%)`;
                updateDots();

                // Reset Animations for text re-trigger (Optional trick)
                // Note: AOS only runs once by default, so we rely on CSS transitions mostly here.
            }

            function nextSlide() {
                let next = (currentSlide + 1) % totalSlides;
                goToSlide(next);
            }

            function resetInterval() {
                clearInterval(slideInterval);
                slideInterval = setInterval(nextSlide, 7000); // 7s for better reading
            }

            slideInterval = setInterval(nextSlide, 7000);
        }

        // --- 2. AI CHAT LOGIC (Preserved & Styled) ---
        const toggleBtn = document.getElementById('toggle-chat');
        const chatWindow = document.getElementById('ai-chat-window');
        const closeChatBtn = document.getElementById('close-chat');
        const clearChatBtn = document.getElementById('clear-chat');
        const headerChat = document.getElementById('header-chat');
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');
        const messagesContainer = document.getElementById('chat-messages');
        const STORAGE_KEY = 'codecampus_ai_chat_history';

        const INTRO_MSG = `
            <div class="flex items-start gap-3 message-enter" id="intro-msg">
                <div class="w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center text-xs shrink-0 text-slate-700 shadow-sm">ü§ñ</div>
                <div class="flex flex-col space-y-1 max-w-[85%]">
                    <div class="bg-white text-slate-700 px-4 py-3 rounded-2xl rounded-tl-none text-[13px] shadow-sm border border-slate-100 leading-relaxed chat-content">
                        <b>Ch√†o b·∫°n! üëã</b><br>
                        M√¨nh l√† tr·ª£ l√Ω AI. B·∫°n c·∫ßn t∆∞ v·∫•n l·ªô tr√¨nh h·ªçc Frontend, Backend hay DevOps?
                    </div>
                </div>
            </div>`;

        function formatMessageContent(text) {
            let safeText = text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
            const urlRegex = /(https?:\/\/[^\s]+)/g;
            safeText = safeText.replace(urlRegex, url => `<a href="${url}" target="_blank" class="text-brand-600 hover:underline font-semibold">${url}</a>`);
            safeText = safeText.replace(/\n/g, '<br>');
            return safeText;
        }

        function loadChatHistory() {
            const history = localStorage.getItem(STORAGE_KEY);
            if (history) {
                try {
                    const messages = JSON.parse(history);
                    if(messages.length === 0) messagesContainer.innerHTML = INTRO_MSG;
                    else messages.forEach(msg => { appendMessage(msg.text, msg.isUser, false); });
                } catch (e) { messagesContainer.innerHTML = INTRO_MSG; }
            } else {
                messagesContainer.innerHTML = INTRO_MSG;
            }
        }

        function saveMessageToStorage(text, isUser) {
            let messages = [];
            const history = localStorage.getItem(STORAGE_KEY);
            if (history) { try { messages = JSON.parse(history); } catch (e) { messages = []; } }
            messages.push({ text: text, isUser: isUser, timestamp: new Date().getTime() });
            localStorage.setItem(STORAGE_KEY, JSON.stringify(messages));
        }

        function toggleChat() {
            const isInvisible = chatWindow.classList.contains('invisible');
            if (isInvisible) {
                chatWindow.classList.remove('invisible', 'opacity-0', 'translate-y-10');
                toggleBtn.classList.add('opacity-0', 'scale-0');
                setTimeout(() => chatInput.focus(), 300);
            } else {
                chatWindow.classList.add('opacity-0', 'translate-y-10');
                toggleBtn.classList.remove('opacity-0', 'scale-0');
                setTimeout(() => chatWindow.classList.add('invisible'), 300);
            }
        }

        toggleBtn.addEventListener('click', toggleChat);
        closeChatBtn.addEventListener('click', toggleChat);
        headerChat.addEventListener('click', (e) => {
            if (e.target.closest('button')) return;
            toggleChat();
        });

        if (clearChatBtn) {
            clearChatBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                if(confirm("X√≥a to√†n b·ªô cu·ªôc tr√≤ chuy·ªán?")) {
                    localStorage.removeItem(STORAGE_KEY);
                    messagesContainer.innerHTML = INTRO_MSG;
                }
            });
        }

        function appendMessage(text, isUser, saveToStorage = true) {
            if (saveToStorage) saveMessageToStorage(text, isUser);

            const div = document.createElement('div');
            div.className = `flex items-start gap-3 message-enter ${isUser ? 'flex-row-reverse' : ''}`;

            const avatar = isUser ? '' : `<div class="w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center text-xs shrink-0 text-slate-700 shadow-sm mt-1">ü§ñ</div>`;

            const bubbleClass = isUser
                ? 'bg-brand-600 text-white rounded-2xl rounded-tr-none shadow-lg shadow-brand-500/30'
                : 'bg-white text-slate-700 rounded-2xl rounded-tl-none shadow-sm border border-slate-100';

            const formattedContent = formatMessageContent(text);

            div.innerHTML = `
                ${avatar}
                <div class="flex flex-col space-y-1 max-w-[85%] ${isUser ? 'items-end' : 'items-start'}">
                    <div class="${bubbleClass} px-4 py-2.5 text-[13px] leading-relaxed chat-content break-words font-medium">
                        ${formattedContent}
                    </div>
                    ${isUser ? '<span class="text-[10px] text-slate-400 mr-1">B·∫°n</span>' : ''}
                </div>
            `;
            messagesContainer.appendChild(div);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function appendLoading() {
            const div = document.createElement('div');
            div.id = 'ai-loading';
            div.className = 'flex items-start gap-3 message-enter';
            div.innerHTML = `
                <div class="w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center text-xs shrink-0 text-slate-700 shadow-sm mt-1">ü§ñ</div>
                <div class="bg-white p-3 rounded-2xl rounded-tl-none shadow-sm border border-slate-100 flex space-x-1 items-center h-10">
                    <span class="w-1.5 h-1.5 bg-brand-400 rounded-full animate-bounce"></span>
                    <span class="w-1.5 h-1.5 bg-brand-500 rounded-full animate-bounce" style="animation-delay: 0.1s"></span>
                    <span class="w-1.5 h-1.5 bg-brand-600 rounded-full animate-bounce" style="animation-delay: 0.2s"></span>
                </div>
            `;
            messagesContainer.appendChild(div);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        chatForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            const message = chatInput.value.trim();
            if (!message) return;

            appendMessage(message, true);
            chatInput.value = '';
            appendLoading();

            try {
                // Gi·∫£ l·∫≠p API
                const response = await fetch('/api/ai/consult', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: message })
                });

                const loadingEl = document.getElementById('ai-loading');
                if (loadingEl) loadingEl.remove();

                if (!response.ok) throw new Error(`Status: ${response.status}`);
                const data = await response.json();

                if (data && data.reply) appendMessage(data.reply, false);
                else appendMessage("Xin l·ªói, m√¨nh ƒëang g·∫∑p ch√∫t tr·ª•c tr·∫∑c.", false);

            } catch (error) {
                const loadingEl = document.getElementById('ai-loading');
                if (loadingEl) loadingEl.remove();
                appendMessage("M·∫•t k·∫øt n·ªëi server. Vui l√≤ng th·ª≠ l·∫°i sau.", false, false);
            }
        });

        loadChatHistory();
    });

    // --- 3. COUNTER ANIMATION ---
    document.addEventListener("DOMContentLoaded", () => {
        const counters = document.querySelectorAll('.counter');
        const speed = 200;

        const animateCounters = () => {
            counters.forEach(counter => {
                const updateCount = () => {
                    const target = +counter.getAttribute('data-target');
                    const count = +counter.innerText;
                    const inc = Math.ceil(target / speed);

                    if (count < target) {
                        counter.innerText = count + inc > target ? target : count + inc;
                        setTimeout(updateCount, 20);
                    } else {
                        counter.innerText = target;
                    }
                };
                updateCount();
            });
        };

        const observer = new IntersectionObserver((entries) => {
            if (entries[0].isIntersecting) {
                animateCounters();
                observer.disconnect();
            }
        }, { threshold: 0.5 });

        const statsSection = document.getElementById('system-stats');
        if (statsSection) {
            observer.observe(statsSection);
        }
    });
</script>
</body>
</html>